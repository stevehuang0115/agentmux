(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{216:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var n=t(5155),r=t(2115),c=t(9829);class a{connect(){var e;if((null==(e=this.socket)?void 0:e.connected)||this.isConnecting)return this.socket;this.isConnecting=!0;let s=window.location.origin;return this.socket=(0,c.io)(s,{autoConnect:!0,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3}),this.socket.on("connect",()=>{var e;console.log("Socket connected:",null==(e=this.socket)?void 0:e.id),this.isConnecting=!1}),this.socket.on("disconnect",e=>{console.log("Socket disconnected:",e),this.isConnecting=!1}),this.socket.on("connect_error",e=>{console.error("Socket connection error:",e),this.isConnecting=!1}),this.socket}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null),this.isConnecting=!1}getSocket(){return this.socket}async listSessions(){return new Promise((e,s)=>{var t;if(!(null==(t=this.socket)?void 0:t.connected))return void s(Error("Socket not connected"));this.socket.emit("list-sessions",t=>{t.success&&t.data?e(t.data):s(Error(t.error||"Failed to list sessions"))})})}async sendMessage(e){return new Promise((s,t)=>{var n;if(!(null==(n=this.socket)?void 0:n.connected))return void t(Error("Socket not connected"));this.socket.emit("send-message",e,e=>{e.success?s(!0):t(Error(e.error||"Failed to send message"))})})}async capturePane(e,s,t,n){return new Promise((r,c)=>{var a;if(!(null==(a=this.socket)?void 0:a.connected))return void c(Error("Socket not connected"));this.socket.emit("capture-pane",{session:e,window:s,pane:t,lines:n},e=>{e.success&&void 0!==e.data?r(e.data):c(Error(e.error||"Failed to capture pane"))})})}async createWindow(e,s,t){return new Promise((n,r)=>{var c;if(!(null==(c=this.socket)?void 0:c.connected))return void r(Error("Socket not connected"));this.socket.emit("create-window",{session:e,name:s,workingDir:t},e=>{e.success?n(!0):r(Error(e.error||"Failed to create window"))})})}async killWindow(e,s){return new Promise((t,n)=>{var r;if(!(null==(r=this.socket)?void 0:r.connected))return void n(Error("Socket not connected"));this.socket.emit("kill-window",{session:e,window:s},e=>{e.success?t(!0):n(Error(e.error||"Failed to kill window"))})})}constructor(){this.socket=null,this.isConnecting=!1}}let i=new a;var o=t(3166),l=t(3738),d=t(6132),x=t(6154);function m(e){let{sessionsCount:s}=e,[t,c]=(0,r.useState)("connecting"),[a,m]=(0,r.useState)("");return(0,r.useEffect)(()=>{let e=i.connect(),s=()=>{c("connected"),m("ID: ".concat(e.id))},t=()=>{c("disconnected"),m("Disconnected from server")},n=e=>{c("error"),m("Error: ".concat(e.message||"Connection failed"))};return e.on("connect",s),e.on("disconnect",t),e.on("connect_error",n),e.connected&&s(),()=>{e.off("connect",s),e.off("disconnect",t),e.off("connect_error",n)}},[]),(0,n.jsxs)("header",{className:"bg-white border-b border-gray-200 shadow-sm",children:[(0,n.jsxs)("div",{className:"px-6 py-4 flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("div",{className:"flex items-center justify-center w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg",children:(0,n.jsx)(x.A,{className:"w-6 h-6 text-white"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h1",{className:"text-xl font-bold text-gray-900",children:"AgentMux"}),(0,n.jsx)("p",{className:"text-sm text-gray-600",children:"Tmux Session Manager"})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,n.jsx)("span",{className:"font-medium",children:s}),(0,n.jsxs)("span",{children:["session",1!==s?"s":""]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2 px-3 py-2 rounded-full text-sm font-medium ".concat((()=>{switch(t){case"connected":return"text-green-600 bg-green-100";case"disconnected":case"error":return"text-red-600 bg-red-100";case"connecting":return"text-yellow-600 bg-yellow-100";default:return"text-gray-600 bg-gray-100"}})()),children:[(()=>{switch(t){case"connected":return(0,n.jsx)(o.A,{className:"w-4 h-4"});case"disconnected":default:return(0,n.jsx)(l.A,{className:"w-4 h-4"});case"connecting":return(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-current"});case"error":return(0,n.jsx)(d.A,{className:"w-4 h-4"})}})(),(0,n.jsx)("span",{children:(()=>{switch(t){case"connected":return"Connected";case"disconnected":return"Disconnected";case"connecting":return"Connecting...";case"error":return"Error";default:return"Unknown"}})()})]}),a&&(0,n.jsx)("div",{className:"hidden lg:block",children:(0,n.jsx)("span",{className:"text-xs text-gray-500 font-mono",title:a,children:"connected"===t?"●":"○"})})]})]})]}),"error"===t&&(0,n.jsx)("div",{className:"bg-red-50 border-b border-red-200 px-6 py-2",children:(0,n.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-red-700",children:[(0,n.jsx)(d.A,{className:"w-4 h-4"}),(0,n.jsxs)("span",{children:["Connection Error: ",a]}),(0,n.jsx)("button",{onClick:()=>window.location.reload(),className:"ml-4 text-red-800 hover:text-red-900 underline",children:"Retry"})]})})]})}var h=t(803),u=t(9451);function g(e){let{sessions:s,onWindowSelect:t,selectedTarget:c,isLoading:a}=e,[i,o]=(0,r.useState)(new Set);return((0,r.useEffect)(()=>{s.length>0&&0===i.size&&o(new Set([s[0].name]))},[s,i.size]),a)?(0,n.jsx)("div",{className:"w-80 bg-white border-r border-gray-200 flex items-center justify-center",children:(0,n.jsxs)("div",{className:"flex flex-col items-center space-y-3 text-gray-500",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,n.jsx)("span",{className:"text-sm",children:"Loading sessions..."})]})}):(0,n.jsxs)("div",{className:"w-80 bg-white border-r border-gray-200 flex flex-col",children:[(0,n.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-gradient-to-r from-blue-50 to-purple-50",children:(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-100 rounded-lg",children:(0,n.jsx)(h.A,{className:"w-5 h-5 text-blue-600"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Tmux Sessions"}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[s.length," session",1!==s.length?"s":""," active"]})]})]})}),(0,n.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===s.length?(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[(0,n.jsx)(u.A,{className:"w-12 h-12 mb-3 text-gray-300"}),(0,n.jsxs)("p",{className:"text-sm text-center px-4",children:["No active tmux sessions found.",(0,n.jsx)("br",{}),(0,n.jsx)("span",{className:"text-xs text-gray-400",children:"Start a new session to get started."})]})]}):(0,n.jsx)("div",{className:"p-2",children:s.map(e=>(0,n.jsxs)("div",{className:"mb-2",children:[(0,n.jsxs)("button",{onClick:()=>(e=>{let s=new Set(i);s.has(e)?s.delete(e):s.add(e),o(s)})(e.name),className:"w-full flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors group",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)("div",{className:"flex items-center justify-center w-8 h-8 bg-green-100 rounded-md group-hover:bg-green-200 transition-colors",children:(0,n.jsx)(x.A,{className:"w-4 h-4 text-green-600"})}),(0,n.jsxs)("div",{className:"text-left",children:[(0,n.jsx)("div",{className:"font-medium text-gray-900",children:e.name}),(0,n.jsxs)("div",{className:"text-xs text-gray-500",children:[e.windows.length," window",1!==e.windows.length?"s":""]})]})]}),(0,n.jsx)("div",{className:"transition-transform ".concat(i.has(e.name)?"rotate-90":""),children:(0,n.jsx)("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),i.has(e.name)&&(0,n.jsx)("div",{className:"ml-4 pl-4 border-l-2 border-gray-100",children:e.windows.map(s=>{let r=c==="".concat(e.name,":").concat(s.index);return(0,n.jsxs)("button",{onClick:()=>t(e.name,s),className:"w-full flex items-center space-x-3 p-2 rounded-md transition-all text-left ".concat(r?"bg-blue-100 border-l-4 border-blue-500 text-blue-900":"hover:bg-gray-50 text-gray-700"),children:[(0,n.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-md flex items-center justify-center text-xs font-medium ".concat(s.active?"bg-green-500 text-white":r?"bg-blue-500 text-white":"bg-gray-200 text-gray-600"),children:s.index}),(0,n.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,n.jsx)("div",{className:"text-sm font-medium truncate ".concat(r?"text-blue-900":"text-gray-900"),children:s.name}),s.active&&(0,n.jsx)("div",{className:"text-xs text-green-600",children:"Active"})]})]},s.index)})})]},e.name))})})]})}var f=t(9559),j=t(1360),b=t(5870),w=t(1397),p=t(8085);function v(e){let{selectedSession:s,selectedWindow:t,output:c,isLoading:a,onSendCommand:i,onRefresh:o,onClear:l}=e,[d,x]=(0,r.useState)(""),[m,u]=(0,r.useState)(!1),g=(0,r.useRef)(null);(0,r.useEffect)(()=>{g.current&&(g.current.scrollTop=g.current.scrollHeight)},[c]);let v=async()=>{if(d.trim()&&!m){u(!0);try{await i(d.trim()),x("")}catch(e){console.error("Failed to send command:",e)}finally{u(!1)}}};return s&&t?(0,n.jsxs)("div",{className:"flex-1 flex flex-col bg-white",children:[(0,n.jsx)("div",{className:"flex-shrink-0 border-b border-gray-200 bg-gradient-to-r from-gray-50 to-blue-50",children:(0,n.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)("div",{className:"flex items-center justify-center w-10 h-10 bg-blue-100 rounded-lg",children:(0,n.jsx)(h.A,{className:"w-5 h-5 text-blue-600"})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("h2",{className:"text-lg font-semibold text-gray-900",children:[s,":",t.index]}),(0,n.jsxs)("p",{className:"text-sm text-gray-600",children:[t.name," ",t.active&&(0,n.jsx)("span",{className:"text-green-600",children:"• Active"})]})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsxs)("button",{onClick:o,disabled:a,className:"flex items-center space-x-2 px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,n.jsx)(f.A,{className:"w-4 h-4 ".concat(a?"animate-spin":"")}),(0,n.jsx)("span",{children:"Refresh"})]}),(0,n.jsxs)("button",{onClick:l,className:"flex items-center space-x-2 px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:[(0,n.jsx)(j.A,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:"Clear"})]}),(0,n.jsx)("button",{className:"flex items-center space-x-2 px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:(0,n.jsx)(b.A,{className:"w-4 h-4"})}),(0,n.jsx)("button",{className:"flex items-center space-x-2 px-3 py-2 text-sm bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:(0,n.jsx)(w.A,{className:"w-4 h-4"})})]})]})}),(0,n.jsx)("div",{ref:g,className:"flex-1 p-6 overflow-y-auto bg-gray-900 text-gray-100 font-mono text-sm leading-relaxed",children:a&&!c?(0,n.jsxs)("div",{className:"flex items-center space-x-3 text-gray-400",children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-gray-400"}),(0,n.jsx)("span",{children:"Loading output..."})]}):(0,n.jsx)("pre",{className:"whitespace-pre-wrap break-words",children:c||(0,n.jsx)("span",{className:"text-gray-500 italic",children:"No output available. Send a command to see output here."})})}),(0,n.jsxs)("div",{className:"flex-shrink-0 border-t border-gray-200 bg-white p-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsxs)("div",{className:"flex-1 relative",children:[(0,n.jsx)("input",{type:"text",value:d,onChange:e=>x(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),v())},placeholder:"Enter command to send to tmux session...",className:"w-full pl-4 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-gray-50 text-gray-900 font-mono text-sm",disabled:m}),(0,n.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,n.jsx)("kbd",{className:"px-2 py-1 text-xs text-gray-500 bg-gray-200 rounded",children:"↵"})})]}),(0,n.jsx)("button",{onClick:v,disabled:!d.trim()||m,className:"flex items-center space-x-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg font-medium transition-colors",children:m?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),(0,n.jsx)("span",{children:"Sending"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.A,{className:"w-4 h-4"}),(0,n.jsx)("span",{children:"Send"})]})})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between mt-3 text-xs text-gray-500",children:[(0,n.jsx)("span",{children:"Press Enter to send command"}),(0,n.jsxs)("span",{children:["Connected to ",s,":",t.index]})]})]})]}):(0,n.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gray-50",children:(0,n.jsxs)("div",{className:"text-center space-y-4 max-w-md",children:[(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-full flex items-center justify-center",children:(0,n.jsx)(h.A,{className:"w-8 h-8 text-gray-400"})})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a tmux session"}),(0,n.jsx)("p",{className:"text-gray-600",children:"Choose a session and window from the left panel to view output and send commands."})]})]})})}function y(){let[e,s]=(0,r.useState)([]),[t,c]=(0,r.useState)(null),[a,o]=(0,r.useState)(null),[l,d]=(0,r.useState)(null),[x,h]=(0,r.useState)(""),[u,f]=(0,r.useState)(!0),[j,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{w()},[]);let w=async()=>{f(!0);try{let e=i.connect();await new Promise(s=>{e.connected?s(void 0):e.once("connect",()=>s(void 0))});let t=await i.listSessions();s(t)}catch(e){console.error("Failed to load sessions:",e),s([])}finally{f(!1)}},p=async(e,s)=>{c(e),o(s),d("".concat(e,":").concat(s.index)),h(""),await y(e,s.index)},y=async(e,s)=>{let n=e||t,r=void 0!==s?s:null==a?void 0:a.index;if(n&&void 0!==r){b(!0);try{let e=await i.capturePane(n,r,void 0,100);h(e)}catch(e){console.error("Failed to refresh output:",e),h("Error: ".concat(e instanceof Error?e.message:"Unknown error"))}finally{b(!1)}}},N=async e=>{if(!t||!a)throw Error("No session or window selected");await i.sendMessage({session:t,window:a.index,message:e}),setTimeout(()=>y(),500)};return(0,n.jsxs)("div",{className:"h-screen flex flex-col bg-gray-50",children:[(0,n.jsx)(m,{sessionsCount:e.length}),(0,n.jsxs)("div",{className:"flex-1 flex overflow-hidden",children:[(0,n.jsx)(g,{sessions:e,onWindowSelect:p,selectedTarget:l,isLoading:u}),(0,n.jsx)(v,{selectedSession:t,selectedWindow:a,output:x,isLoading:j,onSendCommand:N,onRefresh:()=>y(),onClear:()=>{h("")}})]})]})}},7788:(e,s,t)=>{Promise.resolve().then(t.bind(t,216))}},e=>{e.O(0,[143,441,255,358],()=>e(e.s=7788)),_N_E=e.O()}]);